<figure>
	{{- if .Get "link" -}}
	<a href="{{ .Get "link" }}">
  {{- end -}}

	{{ .Scratch.Set "src" (.Get "src") }}
	{{ with .Get "alt" }}
	{{ $.Scratch.Set "alt" . }}
	{{ end }}
	{{ with .Get "sizes" }}
	{{ $.Scratch.Set "sizes" . }}
	{{ end }}
	{{ with .Get "webp_mode" }}
	{{ $.Scratch.Set "webp_mode" }}
	{{ end }}
  {{ partial "picture" . }}

	{{- if .Get "link" }}</a>{{ end -}}
  {{ with .Get "caption" }}<figcaption>{{- . | markdownify -}}</figcaption>{{ end }}
</figure>
